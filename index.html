<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WFM Scheduling Tool | Customer Operations</title>
  <style>
    :root {
      --primary-color: #3b82f6;
      --secondary-color: #1d4ed8;
      --border-color: #e5e7eb;
      --light-bg: #f8fafc;
      --card-bg: #FFFFFF;
      --text-color: #1f2937;
      --text-light: #6b7280;
      --warn: #f59e0b;
      --bad: #dc2626;
      --good: #16a34a;
      --schedule-inbound: #3b82f6;
      --schedule-break: #f59e0b;
      --schedule-lunch: #dc2626;
      --schedule-meeting: #8b5cf6;
      --schedule-coaching: #10b981;
      --schedule-vacation: #94a3b8;
      --schedule-training: #6366f1;
      --schedule-onqueue: #3b82f6;
      --schedule-available: #dbeafe;
      --schedule-unavailable: #f3f4f6;
      --modified: #8b5cf6;
    }
    
    body, h1, h2, h3, h4, h5, h6, p, div, span, label, button, input, select, textarea, th, td, li, ul, ol {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    }
    
    body {
      margin: 0;
      padding: 20px;
      background: var(--light-bg);
      color: var(--text-color);
      min-height: 100vh;
    }
    
    .container {
      max-width: 1600px;
      margin: 0 auto;
    }

    /* Header */
    .header {
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 2px solid var(--border-color);
    }
    
    .breadcrumb {
      font-size: 14px;
      color: var(--text-light);
      margin-bottom: 8px;
    }
    
    .breadcrumb a {
      color: var(--primary-color);
      text-decoration: none;
    }
    
    .breadcrumb a:hover {
      text-decoration: underline;
    }
    
    .page-title {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
    }
    
    .page-title h1 {
      margin: 0;
      font-size: 28px;
      font-weight: 700;
      color: var(--text-color);
    }
    
    .page-subtitle {
      color: var(--text-light);
      font-size: 16px;
      margin-bottom: 20px;
    }

    /* Tabs */
    .tabs-container {
      margin-bottom: 24px;
    }
    
    .tabs {
      display: flex;
      border-bottom: 2px solid var(--border-color);
      margin-bottom: 24px;
    }
    
    .tab {
      padding: 12px 24px;
      background: none;
      border: none;
      font-size: 16px;
      font-weight: 600;
      color: var(--text-light);
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
      border-bottom: 2px solid transparent;
      margin-bottom: -2px;
    }
    
    .tab:hover {
      color: var(--primary-color);
    }
    
    .tab.active {
      color: var(--primary-color);
      border-bottom-color: var(--primary-color);
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }

    /* Main Content */
    .main-content {
      display: grid;
      grid-template-columns: 300px 1fr;
      gap: 24px;
    }
    
    @media (max-width: 1200px) {
      .main-content {
        grid-template-columns: 1fr;
      }
    }

    /* Sidebar */
    .sidebar {
      background: white;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 24px;
      box-shadow: 0 1px 3px rgba(0,0,0,.08);
    }
    
    .sidebar-section {
      margin-bottom: 32px;
    }
    
    .sidebar-section:last-child {
      margin-bottom: 0;
    }
    
    .sidebar-section h3 {
      margin: 0 0 16px 0;
      font-size: 16px;
      font-weight: 600;
      color: var(--text-color);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .agent-count {
      background: var(--primary-color);
      color: white;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
    }

    /* Agent List */
    .agent-list {
      max-height: 500px;
      overflow-y: auto;
    }
    
    .agent-item {
      padding: 12px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      margin-bottom: 8px;
      background: white;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .agent-item:hover {
      border-color: var(--primary-color);
      background: var(--schedule-available);
    }
    
    .agent-item.selected {
      border-color: var(--primary-color);
      background: var(--schedule-available);
      box-shadow: 0 0 0 1px var(--primary-color);
    }
    
    .agent-name {
      font-weight: 600;
      margin-bottom: 4px;
      color: var(--text-color);
    }
    
    .agent-hours {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      color: var(--text-light);
    }
    
    .agent-hour {
      text-align: center;
    }
    
    .hour-label {
      font-size: 11px;
      color: var(--text-light);
    }
    
    .hour-value {
      font-weight: 600;
      color: var(--text-color);
    }

    /* Schedule View */
    .schedule-view {
      background: white;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0,0,0,.08);
    }

    /* Schedule Header */
    .schedule-header {
      padding: 20px 24px;
      border-bottom: 1px solid var(--border-color);
      background: var(--light-bg);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 15px;
    }
    
    .schedule-controls {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .date-info {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .date-display {
      font-size: 18px;
      font-weight: 700;
      color: var(--text-color);
    }
    
    .day-indicator {
      background: var(--primary-color);
      color: white;
      padding: 4px 12px;
      border-radius: 16px;
      font-size: 12px;
      font-weight: 600;
    }
    
    /* Net Staffing Ribbon */
    .net-staffing-ribbon {
      background: white;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 15px;
      margin: 0 24px 20px 24px;
      overflow-x: auto;
    }

    .net-staffing-title {
      font-weight: 700;
      font-size: 14px;
      margin-bottom: 10px;
      color: var(--secondary-color);
    }

    .net-staffing-grid {
      display: grid;
      grid-auto-flow: column;
      grid-auto-columns: minmax(60px, 1fr);
      gap: 2px;
      min-height: 60px;
    }

    .net-staffing-cell {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 8px 4px;
      border-radius: 4px;
      font-size: 11px;
      text-align: center;
      border: 1px solid var(--border-color);
    }

    .net-staffing-cell.adequate {
      background: rgba(22, 163, 74, 0.1);
      border-color: rgba(22, 163, 74, 0.3);
    }

    .net-staffing-cell.shortage {
      background: rgba(239, 68, 68, 0.1);
      border-color: rgba(239, 68, 68, 0.3);
    }

    .net-staffing-cell.overstaffed {
      background: rgba(59, 130, 246, 0.1);
      border-color: rgba(59, 130, 246, 0.3);
    }

    .net-staffing-time {
      font-weight: 600;
      font-size: 10px;
      color: var(--text-light);
      margin-bottom: 3px;
    }

    .net-staffing-value {
      font-weight: 700;
      font-size: 16px;
    }

    .net-staffing-value.positive {
      color: var(--good);
    }

    .net-staffing-value.negative {
      color: var(--bad);
    }

    .net-staffing-value.neutral {
      color: var(--text-color);
    }

    .net-staffing-label {
      font-size: 9px;
      color: var(--text-light);
      margin-top: 2px;
    }
    
    /* Interval Selector */
    .interval-selector {
      display: flex;
      gap: 5px;
      background: white;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 4px;
    }

    .interval-selector button {
      padding: 6px 12px;
      font-size: 12px;
      min-width: 50px;
      background: transparent;
      color: var(--text-color);
      border: none;
    }

    .interval-selector button.active {
      background: var(--primary-color);
      color: white;
    }
    
    /* Daily Schedule Grid */
    .daily-schedule-grid {
      border: 1px solid var(--border-color);
      border-radius: 8px;
      overflow: hidden;
      background: white;
      margin: 0 24px 20px 24px;
      overflow-x: auto;
    }

    .schedule-grid-header {
      display: grid;
      grid-auto-flow: column;
      grid-auto-columns: minmax(40px, 1fr);
      background: var(--primary-color);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .schedule-time-header {
      padding: 10px 4px;
      text-align: center;
      font-size: 11px;
      font-weight: 600;
      color: white;
      border-right: 1px solid rgba(255, 255, 255, 0.2);
      min-width: 120px;
      position: sticky;
      left: 0;
      background: var(--primary-color);
      z-index: 101;
    }

    .schedule-interval-header {
      padding: 8px 4px;
      text-align: center;
      font-size: 10px;
      font-weight: 600;
      color: white;
      border-right: 1px solid rgba(255, 255, 255, 0.2);
    }

    .schedule-agent-row {
      display: grid;
      grid-auto-flow: column;
      grid-auto-columns: minmax(40px, 1fr);
      border-bottom: 1px solid var(--border-color);
    }

    .schedule-agent-row:last-child {
      border-bottom: none;
    }

    .schedule-agent-name {
      padding: 12px 8px;
      font-weight: 600;
      font-size: 12px;
      background: rgba(99, 171, 143, 0.05);
      border-right: 1px solid var(--border-color);
      min-width: 120px;
      position: sticky;
      left: 0;
      z-index: 10;
      display: flex;
      align-items: center;
    }

    .schedule-activity-cell {
      padding: 4px;
      text-align: center;
      border-right: 1px solid var(--border-color);
      font-size: 10px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 50px;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }

    .schedule-activity-cell:hover {
      box-shadow: inset 0 0 0 2px var(--primary-color);
    }

    .schedule-activity-cell.modified {
      border: 2px solid var(--modified);
    }

    .schedule-activity-cell.on-queue {
      background: rgba(99, 171, 143, 0.3);
      color: var(--secondary-color);
    }

    .schedule-activity-cell.break {
      background: rgba(245, 158, 11, 0.3);
      color: var(--warn);
    }

    .schedule-activity-cell.lunch {
      background: rgba(220, 38, 38, 0.3);
      color: var(--bad);
    }

    .schedule-activity-cell.meeting {
      background: rgba(37, 99, 235, 0.3);
      color: #2563eb;
    }

    .schedule-activity-cell.coaching {
      background: rgba(147, 51, 234, 0.3);
      color: #9333ea;
    }

    .schedule-activity-cell.off {
      background: rgba(156, 163, 175, 0.1);
      color: var(--text-light);
    }

    .schedule-activity-cell.overtime-opportunity {
      background: repeating-linear-gradient(
        45deg,
        rgba(245, 158, 11, 0.1),
        rgba(245, 158, 11, 0.1) 10px,
        rgba(245, 158, 11, 0.2) 10px,
        rgba(245, 158, 11, 0.2) 20px
      );
      border: 1px dashed var(--warn);
      color: var(--warn);
    }

    .overtime-badge {
      position: absolute;
      top: 2px;
      right: 2px;
      background: var(--warn);
      color: white;
      font-size: 8px;
      padding: 1px 4px;
      border-radius: 3px;
      font-weight: 700;
    }

    /* Stats Bar */
    .stats-bar {
      display: flex;
      gap: 24px;
      padding: 16px 24px;
      background: var(--light-bg);
      border-bottom: 1px solid var(--border-color);
    }
    
    .stat-item {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .stat-value {
      font-size: 24px;
      font-weight: 700;
      color: var(--text-color);
    }
    
    .stat-label {
      font-size: 12px;
      color: var(--text-light);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Legend */
    .schedule-legend {
      padding: 20px 24px;
      border-top: 1px solid var(--border-color);
      background: var(--light-bg);
    }
    
    .legend-title {
      font-weight: 600;
      margin-bottom: 12px;
      color: var(--text-color);
    }
    
    .legend-items {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .legend-color {
      width: 16px;
      height: 16px;
      border-radius: 4px;
    }
    
    .legend-label {
      font-size: 13px;
      color: var(--text-color);
    }

    /* Action Bar */
    .action-bar {
      padding: 20px 24px;
      border-top: 1px solid var(--border-color);
      background: white;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .action-buttons {
      display: flex;
      gap: 12px;
    }
    
    .primary-btn {
      padding: 10px 20px;
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .primary-btn:hover {
      background: var(--secondary-color);
      transform: translateY(-1px);
    }
    
    .secondary-btn {
      padding: 10px 20px;
      background: white;
      color: var(--primary-color);
      border: 1px solid var(--primary-color);
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .secondary-btn:hover {
      background: var(--light-bg);
    }
    
    .publish-info {
      font-size: 14px;
      color: var(--text-light);
    }
    
    .publish-date {
      color: var(--good);
      font-weight: 600;
    }

    /* Save Indicator */
    .save-indicator {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: white;
      border: 2px solid var(--primary-color);
      border-radius: 8px;
      padding: 12px 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      display: none;
      align-items: center;
      gap: 10px;
      z-index: 999;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        transform: translateY(100px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .save-indicator.show {
      display: flex;
    }

    .save-indicator-icon {
      font-size: 20px;
    }

    .save-indicator-text {
      font-weight: 600;
      color: var(--secondary-color);
    }

    /* Modal Overlay */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal {
      background: white;
      border-radius: 8px;
      width: 90%;
      max-width: 500px;
      max-height: 90vh;
      overflow-y: auto;
    }

    .modal-header {
      padding: 20px 24px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-header h2 {
      margin: 0;
      font-size: 20px;
      color: var(--text-color);
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--text-light);
    }

    .modal-body {
      padding: 24px;
    }

    /* Publish Options */
    .publish-option {
      padding: 15px;
      border: 2px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 15px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .publish-option:hover {
      border-color: var(--primary-color);
      background: rgba(99, 171, 143, 0.05);
    }

    .publish-option.selected {
      border-color: var(--primary-color);
      background: rgba(99, 171, 143, 0.1);
    }

    .publish-option input[type="radio"] {
      width: auto;
      margin-right: 10px;
    }

    .publish-option-title {
      font-weight: 700;
      font-size: 15px;
      margin-bottom: 5px;
    }

    .publish-option-description {
      font-size: 12px;
      color: var(--text-light);
    }

    .date-range-inputs {
      margin-top: 15px;
      padding: 15px;
      background: rgba(99, 171, 143, 0.05);
      border-radius: 8px;
      display: none;
    }

    .date-range-inputs.active {
      display: block;
    }

    /* Form Elements */
    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--text-color);
    }

    .form-group input[type="date"],
    .form-group select {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      font-size: 14px;
    }

    .row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }

    .note {
      background: rgba(245, 158, 11, 0.1);
      border-left: 4px solid var(--warn);
      padding: 12px;
      margin: 20px 0;
      font-size: 14px;
    }

    .btn-group {
      display: flex;
      gap: 12px;
      margin-top: 24px;
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: var(--primary-color);
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: var(--secondary-color);
    }

    /* Responsive */
    @media (max-width: 768px) {
      body {
        padding: 12px;
      }
      
      .main-content {
        grid-template-columns: 1fr;
      }
      
      .stats-bar {
        flex-wrap: wrap;
        gap: 16px;
      }
      
      .action-bar {
        flex-direction: column;
        gap: 16px;
        align-items: stretch;
      }
      
      .action-buttons {
        flex-direction: column;
      }
      
      .schedule-header {
        flex-direction: column;
        align-items: stretch;
      }
      
      .schedule-controls {
        flex-wrap: wrap;
      }
      
      .net-staffing-grid {
        grid-auto-columns: minmax(50px, 1fr);
      }
      
      .row {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <div class="breadcrumb">
        <a href="#">Schedules</a> / <a href="#">Customer Operations</a> / <span>Residential</span>
      </div>
      <div class="page-title">
        <h1>WFM Scheduling Tool</h1>
      </div>
      <div class="page-subtitle">
        Customer Service - Daily Schedule View
      </div>
    </div>

    <!-- Tabs -->
    <div class="tabs-container">
      <div class="tabs">
        <button class="tab active" data-tab="schedule">Daily Schedule</button>
        <button class="tab" data-tab="agents">Agent Management</button>
        <button class="tab" data-tab="configuration">Configuration</button>
        <button class="tab" data-tab="reports">Reports</button>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Sidebar -->
      <div class="sidebar">
        <div class="sidebar-section">
          <h3>Agents <span class="agent-count" id="agentCount">9</span></h3>
          <div class="agent-list" id="agentList">
            <!-- Agent items will be populated by JavaScript -->
          </div>
        </div>
        
        <div class="sidebar-section">
          <h3>Statistics</h3>
          <div class="stats-mini">
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
              <span style="font-size: 14px; color: var(--text-color);">Coverage Rate:</span>
              <span style="font-weight: 600; color: var(--good);" id="coverageRate">92%</span>
            </div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
              <span style="font-size: 14px; color: var(--text-color);">Overtime Hours:</span>
              <span style="font-weight: 600; color: var(--warn);" id="overtimeHours">4.5</span>
            </div>
            <div style="display: flex; justify-content: space-between;">
              <span style="font-size: 14px; color: var(--text-color);">Unfilled Shifts:</span>
              <span style="font-weight: 600; color: var(--bad);" id="unfilledShifts">2</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Schedule View Tab -->
      <div class="tab-content active" id="scheduleTab">
        <div class="schedule-view">
          <!-- Stats Bar -->
          <div class="stats-bar">
            <div class="stat-item">
              <div class="stat-value" id="totalAgents">9</div>
              <div class="stat-label">Total Agents</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="totalHours">78.5</div>
              <div class="stat-label">Total Hours</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="onQueueNow">8</div>
              <div class="stat-label">On Queue Now</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="coverage">92%</div>
              <div class="stat-label">Coverage</div>
            </div>
          </div>

          <!-- Schedule Header -->
          <div class="schedule-header">
            <div class="schedule-controls">
              <button class="secondary-btn" id="prevDayBtn">‚óÄ Prev</button>
              <span id="currentDateDisplay" style="padding: 0 15px; font-weight: 600; font-size: 16px;">Monday, 5 Feb 2024</span>
              <button class="secondary-btn" id="nextDayBtn">Next ‚ñ∂</button>
              
              <div class="interval-selector">
                <button class="interval-btn" data-interval="15">15m</button>
                <button class="interval-btn" data-interval="30">30m</button>
                <button class="interval-btn" data-interval="45">45m</button>
                <button class="interval-btn active" data-interval="60">60m</button>
              </div>
            </div>
            
            <div class="action-buttons">
              <button class="secondary-btn" id="saveChangesBtn" style="display: none;">üíæ Save Changes</button>
              <button class="primary-btn" id="publishBtn">üì§ Publish Schedule</button>
              <button class="secondary-btn" id="generateBtn">üîÑ Generate</button>
            </div>
          </div>

          <!-- Net Staffing Ribbon -->
          <div class="net-staffing-ribbon">
            <div class="net-staffing-title">üìä Net Staffing (Required vs Scheduled)</div>
            <div class="net-staffing-grid" id="netStaffingGrid">
              <!-- Net staffing cells will be generated by JavaScript -->
            </div>
          </div>

          <!-- Daily Schedule Grid -->
          <div class="daily-schedule-grid" id="dailyScheduleGrid">
            <!-- Schedule grid will be generated by JavaScript -->
          </div>

          <!-- Legend -->
          <div class="schedule-legend">
            <div class="legend-title">Activity Legend</div>
            <div class="legend-items">
              <div class="legend-item">
                <div class="legend-color" style="background: rgba(99, 171, 143, 0.3);"></div>
                <span class="legend-label">On Queue</span>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background: rgba(245, 158, 11, 0.3);"></div>
                <span class="legend-label">Break</span>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background: rgba(220, 38, 38, 0.3);"></div>
                <span class="legend-label">Lunch</span>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background: rgba(37, 99, 235, 0.3);"></div>
                <span class="legend-label">Meeting</span>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background: rgba(147, 51, 234, 0.3);"></div>
                <span class="legend-label">Coaching</span>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background: rgba(156, 163, 175, 0.1);"></div>
                <span class="legend-label">Off</span>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background: repeating-linear-gradient(45deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.1) 10px, rgba(245, 158, 11, 0.2) 10px, rgba(245, 158, 11, 0.2) 20px); border: 1px dashed var(--warn);"></div>
                <span class="legend-label">Overtime Opportunity</span>
              </div>
            </div>
          </div>

          <!-- Action Bar -->
          <div class="action-bar">
            <div class="publish-info">
              Last published: <span class="publish-date" id="lastPublishedDate">January 28, 2026</span>
            </div>
            <div class="action-buttons">
              <button class="secondary-btn" id="exportBtn">üì• Export to Excel</button>
              <button class="secondary-btn" id="printBtn">üñ®Ô∏è Print Schedule</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Agent Management Tab -->
      <div class="tab-content" id="agentsTab">
        <div class="schedule-view">
          <div class="schedule-header">
            <h2 style="margin: 0; font-size: 24px; color: var(--text-color);">Agent Management</h2>
          </div>
          <div style="padding: 24px;">
            <p style="color: var(--text-light);">Agent management features would go here.</p>
          </div>
        </div>
      </div>

      <!-- Configuration Tab -->
      <div class="tab-content" id="configurationTab">
        <div class="schedule-view">
          <div class="schedule-header">
            <h2 style="margin: 0; font-size: 24px; color: var(--text-color);">Configuration</h2>
          </div>
          <div style="padding: 24px;">
            <div class="form-group">
              <label>Business Hours</label>
              <div class="row">
                <div>
                  <label>Start Time</label>
                  <select id="businessStart" style="width: 100%; padding: 8px; border: 1px solid var(--border-color); border-radius: 4px;">
                    <option value="7">7:00 AM</option>
                    <option value="8" selected>8:00 AM</option>
                    <option value="9">9:00 AM</option>
                    <option value="10">10:00 AM</option>
                  </select>
                </div>
                <div>
                  <label>End Time</label>
                  <select id="businessEnd" style="width: 100%; padding: 8px; border: 1px solid var(--border-color); border-radius: 4px;">
                    <option value="17">5:00 PM</option>
                    <option value="18" selected>6:00 PM</option>
                    <option value="19">7:00 PM</option>
                    <option value="20">8:00 PM</option>
                  </select>
                </div>
              </div>
            </div>
            
            <div class="form-group">
              <label>Interval Length</label>
              <select id="intervalLength" style="width: 100%; padding: 8px; border: 1px solid var(--border-color); border-radius: 4px;">
                <option value="15">15 minutes</option>
                <option value="30">30 minutes</option>
                <option value="45">45 minutes</option>
                <option value="60" selected>60 minutes</option>
              </select>
            </div>
            
            <div class="form-group">
              <label>Scheduling Rules</label>
              <div style="background: var(--light-bg); padding: 15px; border-radius: 6px;">
                <div style="margin-bottom: 10px;">
                  <input type="checkbox" id="ruleBestFit" checked>
                  <label for="ruleBestFit" style="display: inline; margin-left: 8px;">Best Fit (match agent skills to requirements)</label>
                </div>
                <div style="margin-bottom: 10px;">
                  <input type="checkbox" id="ruleEvenSpread" checked>
                  <label for="ruleEvenSpread" style="display: inline; margin-left: 8px;">Even Spread (distribute workload evenly)</label>
                </div>
                <div style="margin-bottom: 10px;">
                  <input type="checkbox" id="ruleMinGaps" checked>
                  <label for="ruleMinGaps" style="display: inline; margin-left: 8px;">Minimize Gaps in schedules</label>
                </div>
                <div style="margin-bottom: 10px;">
                  <input type="checkbox" id="ruleRespectPreferences" checked>
                  <label for="ruleRespectPreferences" style="display: inline; margin-left: 8px;">Respect Agent Preferences</label>
                </div>
                <div style="margin-bottom: 10px;">
                  <input type="checkbox" id="ruleAvoidOvertime" checked>
                  <label for="ruleAvoidOvertime" style="display: inline; margin-left: 8px;">Avoid Overtime where possible</label>
                </div>
                <div>
                  <input type="checkbox" id="ruleOvertimeOpportunities" checked>
                  <label for="ruleOvertimeOpportunities" style="display: inline; margin-left: 8px;">Generate Overtime Opportunities</label>
                  <div style="font-size: 12px; color: var(--text-light); margin-left: 24px; margin-top: 4px;">Create overtime slots for coverage shortfalls</div>
                </div>
              </div>
            </div>
            
            <div class="btn-group">
              <button class="primary-btn" id="saveConfigBtn">Save Configuration</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Reports Tab -->
      <div class="tab-content" id="reportsTab">
        <div class="schedule-view">
          <div class="schedule-header">
            <h2 style="margin: 0; font-size: 24px; color: var(--text-color);">Reports</h2>
          </div>
          <div style="padding: 24px;">
            <p style="color: var(--text-light);">Reporting features would go here.</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Publish Modal -->
  <div id="publishModal" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h2>üì§ Publish Schedule</h2>
        <button class="modal-close" id="publishModalCloseBtn">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Select publish option:</label>
          
          <div class="publish-option" data-option="current">
            <div>
              <input type="radio" name="publishOption" value="current" id="publishCurrent" checked>
              <label for="publishCurrent" style="display: inline;">
                <div class="publish-option-title">Current Day Only</div>
              </label>
            </div>
            <div class="publish-option-description">Publish schedule for the currently displayed day</div>
          </div>
          
          <div class="publish-option" data-option="all">
            <div>
              <input type="radio" name="publishOption" value="all" id="publishAll">
              <label for="publishAll" style="display: inline;">
                <div class="publish-option-title">All Days</div>
              </label>
            </div>
            <div class="publish-option-description">Publish the entire generated schedule period</div>
          </div>
          
          <div class="publish-option" data-option="range">
            <div>
              <input type="radio" name="publishOption" value="range" id="publishRange">
              <label for="publishRange" style="display: inline;">
                <div class="publish-option-title">Date Range</div>
              </label>
            </div>
            <div class="publish-option-description">Select specific start and end dates</div>
            <div class="date-range-inputs" id="dateRangeInputs">
              <div class="row">
                <div class="form-group">
                  <label for="publishStartDate">Start Date</label>
                  <input type="date" id="publishStartDate">
                </div>
                <div class="form-group">
                  <label for="publishEndDate">End Date</label>
                  <input type="date" id="publishEndDate">
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="note">
          <strong>‚ö†Ô∏è Important:</strong> Publishing will make the schedule available to all agents and managers. Ensure all changes have been saved before publishing.
        </div>
        
        <div class="btn-group">
          <button id="confirmPublishBtn" class="primary-btn">‚úÖ Confirm & Publish</button>
          <button id="cancelPublishBtn" class="secondary-btn">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Save Indicator -->
  <div class="save-indicator" id="saveIndicator">
    <span class="save-indicator-icon">‚úÖ</span>
    <span class="save-indicator-text">Changes saved</span>
  </div>

  <script>
    // Sample data for agents
    const agents = [
      { id: 1, name: "Gerard McGlynn", dailyHours: 10, weeklyHours: 40, avatar: "GM" },
      { id: 2, name: "Matthew Layton-Morris", dailyHours: 10, weeklyHours: 40, avatar: "ML" },
      { id: 3, name: "Iain Bennett", dailyHours: 10, weeklyHours: 40, avatar: "IB" },
      { id: 4, name: "Rhys Turner", dailyHours: 7.5, weeklyHours: 37.5, avatar: "RT" },
      { id: 5, name: "Paul Malen", dailyHours: 7.5, weeklyHours: 37.5, avatar: "PM" },
      { id: 6, name: "Freya DiBernardo", dailyHours: 7.5, weeklyHours: 37.5, avatar: "FD" },
      { id: 7, name: "Beccy Hunt", dailyHours: 7.5, weeklyHours: 37.5, avatar: "BH" },
      { id: 8, name: "Tom Wills", dailyHours: 7.5, weeklyHours: 37.5, avatar: "TW" },
      { id: 9, name: "Annabelle Goymer", dailyHours: 7.5, weeklyHours: 37.5, avatar: "AG" }
    ];

    // Main schedule data object
    let scheduleData = {
      requirements: [],
      staff: [],
      assignments: [],
      generatedSchedule: null,
      currentDayIndex: 0,
      totalDays: 7,
      currentInterval: 60,
      agentSchedules: [],
      netStaffing: [],
      hasUnsavedChanges: false,
      modifiedCells: new Set()
    };

    // Activity types
    const activityTypes = [
      { id: "onqueue", name: "On Queue", color: "on-queue" },
      { id: "break", name: "Break", color: "break" },
      { id: "lunch", name: "Lunch", color: "lunch" },
      { id: "meeting", name: "Meeting", color: "meeting" },
      { id: "coaching", name: "Coaching", color: "coaching" },
      { id: "off", name: "Off", color: "off" }
    ];

    // DOM Elements
    const agentList = document.getElementById("agentList");
    const dailyScheduleGrid = document.getElementById("dailyScheduleGrid");
    const netStaffingGrid = document.getElementById("netStaffingGrid");
    const prevDayBtn = document.getElementById("prevDayBtn");
    const nextDayBtn = document.getElementById("nextDayBtn");
    const currentDateDisplay = document.getElementById("currentDateDisplay");
    const intervalBtns = document.querySelectorAll('.interval-btn');
    const saveChangesBtn = document.getElementById("saveChangesBtn");
    const publishBtn = document.getElementById("publishBtn");
    const generateBtn = document.getElementById("generateBtn");
    const publishModal = document.getElementById("publishModal");
    const publishModalCloseBtn = document.getElementById("publishModalCloseBtn");
    const confirmPublishBtn = document.getElementById("confirmPublishBtn");
    const cancelPublishBtn = document.getElementById("cancelPublishBtn");
    const saveIndicator = document.getElementById("saveIndicator");
    const saveConfigBtn = document.getElementById("saveConfigBtn");
    const exportBtn = document.getElementById("exportBtn");
    const printBtn = document.getElementById("printBtn");

    // Initialize
    function init() {
      renderAgentList();
      generateSampleSchedule();
      setupEventListeners();
      updateDateDisplay();
      renderDailySchedule();
      renderNetStaffing();
    }

    // Render agent list
    function renderAgentList() {
      agentList.innerHTML = "";
      
      agents.forEach(agent => {
        const agentItem = document.createElement("div");
        agentItem.className = "agent-item";
        agentItem.dataset.agentId = agent.id;
        
        agentItem.innerHTML = `
          <div class="agent-name">${agent.name}</div>
          <div class="agent-hours">
            <div class="agent-hour">
              <div class="hour-label">Daily</div>
              <div class="hour-value">${agent.dailyHours}h</div>
            </div>
            <div class="agent-hour">
              <div class="hour-label">Weekly</div>
              <div class="hour-value">${agent.weeklyHours}h</div>
            </div>
          </div>
        `;
        
        agentItem.addEventListener("click", () => {
          document.querySelectorAll(".agent-item").forEach(item => {
            item.classList.remove("selected");
          });
          agentItem.classList.add("selected");
          
          // Scroll to agent row in schedule
          const agentRows = document.querySelectorAll('.schedule-agent-row');
          const agentRow = Array.from(agentRows).find(row => {
            const nameCell = row.querySelector('.schedule-agent-name');
            return nameCell && nameCell.textContent.includes(agent.name.split(' ')[0]);
          });
          
          if (agentRow) {
            agentRow.scrollIntoView({ behavior: "smooth", block: "nearest" });
          }
        });
        
        agentList.appendChild(agentItem);
      });
      
      document.getElementById("agentCount").textContent = agents.length;
      document.getElementById("totalAgents").textContent = agents.length;
    }

    // Generate sample schedule data
    function generateSampleSchedule() {
      const intervalLength = scheduleData.currentInterval;
      const config = collectConfiguration();
      const businessStart = config.businessHours.start;
      const businessEnd = config.businessHours.end;
      const intervalsPerHour = 60 / intervalLength;
      const totalIntervals = (businessEnd - businessStart) * intervalsPerHour;
      
      // Generate requirements (random between 5-10 agents required per interval)
      const requirements = [];
      for (let i = 0; i < totalIntervals; i++) {
        requirements.push(Math.floor(Math.random() * 6) + 5);
      }
      
      // Generate agent schedules
      const agentSchedules = [];
      agents.forEach(agent => {
        const schedule = [];
        
        // Generate 7 days of schedule
        for (let day = 0; day < 7; day++) {
          const daySchedule = {
            working: true,
            activities: []
          };
          
          // Random shift pattern
          const shiftStart = businessStart + Math.floor(Math.random() * 4);
          const shiftLength = Math.floor(Math.random() * 4) + 6; // 6-9 hours
          
          // Add activities
          let currentTime = shiftStart;
          
          // Start with on-queue
          const firstActivityDuration = Math.floor(Math.random() * 3) + 2; // 2-4 hours in intervals
          daySchedule.activities.push({
            type: 'inbound',
            activity: 'On Queue',
            start: currentTime,
            end: currentTime + (firstActivityDuration * intervalLength / 60)
          });
          currentTime += firstActivityDuration * intervalLength / 60;
          
          // Add break
          daySchedule.activities.push({
            type: 'break',
            activity: 'Break',
            start: currentTime,
            end: currentTime + (0.5 * intervalLength / 60) // 30min break
          });
          currentTime += 0.5 * intervalLength / 60;
          
          // More on-queue
          const secondActivityDuration = Math.floor(Math.random() * 3) + 2;
          daySchedule.activities.push({
            type: 'inbound',
            activity: 'On Queue',
            start: currentTime,
            end: currentTime + (secondActivityDuration * intervalLength / 60)
          });
          currentTime += secondActivityDuration * intervalLength / 60;
          
          // Add lunch
          daySchedule.activities.push({
            type: 'lunch',
            activity: 'Lunch',
            start: currentTime,
            end: currentTime + (1 * intervalLength / 60) // 1 hour lunch
          });
          currentTime += 1 * intervalLength / 60;
          
          // Final on-queue session
          const remainingTime = (shiftStart + shiftLength) - currentTime;
          if (remainingTime > 0) {
            daySchedule.activities.push({
              type: 'inbound',
              activity: 'On Queue',
              start: currentTime,
              end: currentTime + remainingTime
            });
          }
          
          schedule.push(daySchedule);
        }
        
        agentSchedules.push({
          agentId: agent.id,
          agentName: agent.name,
          schedule: schedule
        });
      });
      
      // Calculate net staffing
      const netStaffing = [];
      for (let day = 0; day < 7; day++) {
        const dayNetStaffing = [];
        
        for (let interval = 0; interval < totalIntervals; interval++) {
          const required = requirements[interval];
          
          // Count scheduled agents for this interval
          let scheduled = 0;
          agentSchedules.forEach(agentSchedule => {
            const daySchedule = agentSchedule.schedule[day];
            if (daySchedule.working) {
              const currentTime = businessStart + (interval * intervalLength / 60);
              
              // Check if agent is scheduled for this time
              const hasActivity = daySchedule.activities.some(activity => 
                activity.start <= currentTime && activity.end > currentTime && activity.type === 'inbound'
              );
              
              if (hasActivity) {
                scheduled++;
              }
            }
          });
          
          const net = scheduled - required;
          let status = 'adequate';
          if (net < -2) status = 'shortage';
          else if (net > 2) status = 'overstaffed';
          
          dayNetStaffing.push({
            intervalIndex: interval,
            required: required,
            scheduled: scheduled,
            net: net,
            status: status
          });
        }
        
        netStaffing.push(dayNetStaffing);
      }
      
      // Create generated schedule object
      scheduleData.generatedSchedule = {
        days: Array.from({length: 7}, (_, i) => {
          const date = new Date();
          date.setDate(date.getDate() + i);
          return { date: date };
        }),
        metrics: {
          totalHours: 78.5,
          coverage: 92,
          overtime: 4.5
        }
      };
      
      scheduleData.agentSchedules = agentSchedules;
      scheduleData.netStaffing = netStaffing;
      scheduleData.totalDays = 7;
      
      // Add some overtime opportunities
      if (document.getElementById('ruleOvertimeOpportunities').checked) {
        scheduleData.generatedSchedule.days.forEach((day, dayIndex) => {
          day.overtimeSlots = [];
          
          // Add random overtime opportunities
          const overtimeCount = Math.floor(Math.random() * 3) + 1;
          for (let i = 0; i < overtimeCount; i++) {
            const randomInterval = Math.floor(Math.random() * totalIntervals);
            day.overtimeSlots.push({
              intervalIndex: randomInterval,
              hour: businessStart + Math.floor(randomInterval * intervalLength / 60),
              minute: (randomInterval * intervalLength) % 60,
              duration: intervalLength,
              available: true
            });
          }
        });
      }
      
      // Update UI stats
      updateStats();
    }

    // Render net staffing ribbon
    function renderNetStaffing() {
      if (!scheduleData.netStaffing || scheduleData.currentDayIndex >= scheduleData.netStaffing.length) {
        netStaffingGrid.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--text-light);">No net staffing data available</div>';
        return;
      }
      
      netStaffingGrid.innerHTML = '';
      
      const dayNetStaffing = scheduleData.netStaffing[scheduleData.currentDayIndex];
      const intervalLength = scheduleData.currentInterval;
      const config = collectConfiguration();
      
      // Filter to show only business hours
      const businessStart = config.businessHours.start;
      const businessEnd = config.businessHours.end;
      
      dayNetStaffing.forEach(interval => {
        const hour = Math.floor((interval.intervalIndex * intervalLength) / 60);
        
        // Only show business hours
        if (hour < businessStart || hour >= businessEnd) return;
        
        const cell = document.createElement('div');
        cell.className = `net-staffing-cell ${interval.status}`;
        
        const minute = (interval.intervalIndex * intervalLength) % 60;
        const timeLabel = document.createElement('div');
        timeLabel.className = 'net-staffing-time';
        timeLabel.textContent = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
        
        const valueLabel = document.createElement('div');
        valueLabel.className = `net-staffing-value ${interval.net >= 0 ? (interval.net > 2 ? 'positive' : 'neutral') : 'negative'}`;
        valueLabel.textContent = interval.net >= 0 ? `+${interval.net}` : interval.net;
        
        const detailLabel = document.createElement('div');
        detailLabel.className = 'net-staffing-label';
        detailLabel.textContent = `${interval.scheduled}/${interval.required}`;
        
        cell.appendChild(timeLabel);
        cell.appendChild(valueLabel);
        cell.appendChild(detailLabel);
        
        netStaffingGrid.appendChild(cell);
      });
    }

    // Render daily schedule grid
    function renderDailySchedule() {
      if (!scheduleData.agentSchedules || scheduleData.agentSchedules.length === 0) {
        dailyScheduleGrid.innerHTML = '<div style="padding: 40px; text-align: center; color: var(--text-light);">No schedule generated yet. Click "Generate Schedule" to create assignments.</div>';
        return;
      }
      
      dailyScheduleGrid.innerHTML = '';
      
      const intervalLength = scheduleData.currentInterval;
      const config = collectConfiguration();
      const businessStart = config.businessHours.start;
      const businessEnd = config.businessHours.end;
      const intervalsPerHour = 60 / intervalLength;
      
      // Create header row
      const headerRow = document.createElement('div');
      headerRow.className = 'schedule-grid-header';
      
      const timeHeader = document.createElement('div');
      timeHeader.className = 'schedule-time-header';
      timeHeader.textContent = 'Agent Name';
      headerRow.appendChild(timeHeader);
      
      // Add interval headers for business hours only
      for (let hour = businessStart; hour < businessEnd; hour++) {
        for (let interval = 0; interval < intervalsPerHour; interval++) {
          const minute = interval * intervalLength;
          const intervalHeader = document.createElement('div');
          intervalHeader.className = 'schedule-interval-header';
          intervalHeader.textContent = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
          headerRow.appendChild(intervalHeader);
        }
      }
      
      dailyScheduleGrid.appendChild(headerRow);
      
      // Create agent rows
      const currentDayIndex = scheduleData.currentDayIndex;
      const overtimeSlots = scheduleData.generatedSchedule?.days[currentDayIndex]?.overtimeSlots || [];
      
      scheduleData.agentSchedules.forEach(agentSchedule => {
        if (currentDayIndex >= agentSchedule.schedule.length) return;
        
        const daySchedule = agentSchedule.schedule[currentDayIndex];
        const row = document.createElement('div');
        row.className = 'schedule-agent-row';
        
        const agentName = document.createElement('div');
        agentName.className = 'schedule-agent-name';
        agentName.textContent = agentSchedule.agentName;
        row.appendChild(agentName);
        
        // Add activity cells for business hours
        for (let hour = businessStart; hour < businessEnd; hour++) {
          for (let interval = 0; interval < intervalsPerHour; interval++) {
            const minute = interval * intervalLength;
            const totalMinutes = hour * 60 + minute;
            const intervalIndex = totalMinutes / intervalLength;
            const currentTime = hour + (minute / 60);
            
            const cell = document.createElement('div');
            cell.className = 'schedule-activity-cell';
            cell.dataset.agent = agentSchedule.agentId;
            cell.dataset.interval = intervalIndex;
            
            // Find activity at this time
            const activity = daySchedule.activities.find(act => 
              act.start <= currentTime && act.end > currentTime
            );
            
            if (activity) {
              cell.classList.add(activity.type === 'inbound' ? 'on-queue' : activity.type);
              cell.textContent = activity.activity;
              
              // Check if cell was modified
              const cellKey = `${agentSchedule.agentId}-${currentDayIndex}-${intervalIndex}`;
              if (scheduleData.modifiedCells.has(cellKey)) {
                cell.classList.add('modified');
              }
            } else if (!daySchedule.working) {
              cell.classList.add('off');
              cell.textContent = '';
            }
            
            // Check if this interval has overtime opportunities
            const hasOvertimeOpp = overtimeSlots.some(slot => 
              Math.abs(slot.intervalIndex - intervalIndex) < 0.5
            );
            
            if (hasOvertimeOpp && !activity) {
              cell.classList.add('overtime-opportunity');
              cell.innerHTML = 'OT<span class="overtime-badge">!</span>';
            }
            
            // Make cell clickable
            cell.addEventListener('click', () => handleCellClick(agentSchedule.agentId, currentDayIndex, intervalIndex, cell));
            
            row.appendChild(cell);
          }
        }
        
        dailyScheduleGrid.appendChild(row);
      });
    }

    // Handle cell click for editing
    function handleCellClick(agentId, dayIndex, intervalIndex, cell) {
      const activities = ['On Queue', 'Break', 'Lunch', 'Meeting', 'Coaching', 'Off'];
      const currentActivity = cell.textContent.replace('OT!', '').trim();
      
      const nextActivityIndex = (activities.indexOf(currentActivity) + 1) % activities.length;
      const nextActivity = activities[nextActivityIndex];
      
      // Update cell appearance
      cell.className = 'schedule-activity-cell modified';
      
      if (nextActivity === 'On Queue') {
        cell.classList.add('on-queue');
      } else if (nextActivity === 'Off') {
        cell.classList.add('off');
      } else {
        cell.classList.add(nextActivity.toLowerCase());
      }
      
      cell.textContent = nextActivity === 'Off' ? '' : nextActivity;
      
      // Track modification
      const cellKey = `${agentId}-${dayIndex}-${intervalIndex}`;
      scheduleData.modifiedCells.add(cellKey);
      scheduleData.hasUnsavedChanges = true;
      
      // Show save button
      saveChangesBtn.style.display = 'inline-block';
    }

    // Navigate to previous day
    function navigatePrevDay() {
      if (scheduleData.currentDayIndex > 0) {
        scheduleData.currentDayIndex--;
        updateDateDisplay();
        renderDailySchedule();
        renderNetStaffing();
      }
    }

    // Navigate to next day
    function navigateNextDay() {
      if (scheduleData.currentDayIndex < scheduleData.totalDays - 1) {
        scheduleData.currentDayIndex++;
        updateDateDisplay();
        renderDailySchedule();
        renderNetStaffing();
      }
    }

    // Update date display
    function updateDateDisplay() {
      if (!scheduleData.generatedSchedule || scheduleData.currentDayIndex >= scheduleData.generatedSchedule.days.length) {
        currentDateDisplay.textContent = 'No date selected';
        return;
      }
      
      const currentDay = scheduleData.generatedSchedule.days[scheduleData.currentDayIndex];
      currentDateDisplay.textContent = formatFullDate(currentDay.date);
    }

    // Format date for full display
    function formatFullDate(date) {
      const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
      const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
      return `${days[date.getDay()]}, ${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}`;
    }

    // Format date for input fields
    function formatDate(date) {
      const year = date.getFullYear();
      const month = (date.getMonth() + 1).toString().padStart(2, '0');
      const day = date.getDate().toString().padStart(2, '0');
      return `${year}-${month}-${day}`;
    }

    // Format date for display
    function formatDisplayDate(dateStr) {
      const date = new Date(dateStr);
      return date.toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' });
    }

    // Collect configuration from form
    function collectConfiguration() {
      return {
        businessHours: {
          start: parseInt(document.getElementById('businessStart').value),
          end: parseInt(document.getElementById('businessEnd').value)
        },
        intervalLength: parseInt(document.getElementById('intervalLength').value),
        rules: collectRules()
      };
    }

    // Collect rules from checkboxes
    function collectRules() {
      return {
        bestFit: document.getElementById('ruleBestFit').checked,
        evenSpread: document.getElementById('ruleEvenSpread').checked,
        minGaps: document.getElementById('ruleMinGaps').checked,
        respectPreferences: document.getElementById('ruleRespectPreferences').checked,
        avoidOvertime: document.getElementById('ruleAvoidOvertime').checked,
        overtimeOpportunities: document.getElementById('ruleOvertimeOpportunities').checked
      };
    }

    // Save changes
    function saveChanges() {
      if (!scheduleData.hasUnsavedChanges) {
        showSaveIndicator('No changes to save');
        return;
      }
      
      // In a real application, this would save to a backend
      console.log('Saving changes...', Array.from(scheduleData.modifiedCells));
      
      scheduleData.hasUnsavedChanges = false;
      saveChangesBtn.style.display = 'none';
      
      showSaveIndicator('Changes saved successfully');
    }

    // Show save indicator
    function showSaveIndicator(message) {
      const indicator = document.getElementById('saveIndicator');
      const textEl = indicator.querySelector('.save-indicator-text');
      textEl.textContent = message;
      
      indicator.classList.add('show');
      
      setTimeout(() => {
        indicator.classList.remove('show');
      }, 3000);
    }

    // Show publish modal
    function showPublishModal() {
      if (!scheduleData.generatedSchedule) {
        alert('Please generate a schedule first.');
        return;
      }
      
      if (scheduleData.hasUnsavedChanges) {
        if (!confirm('You have unsaved changes. Do you want to save them before publishing?')) {
          return;
        }
        saveChanges();
      }
      
      // Set date range defaults
      const firstDay = scheduleData.generatedSchedule.days[0].date;
      const lastDay = scheduleData.generatedSchedule.days[scheduleData.totalDays - 1].date;
      
      document.getElementById('publishStartDate').value = formatDate(firstDay);
      document.getElementById('publishEndDate').value = formatDate(lastDay);
      
      publishModal.style.display = 'flex';
    }

    // Hide publish modal
    function hidePublishModal() {
      publishModal.style.display = 'none';
    }

    // Confirm publish
    function confirmPublish() {
      const selectedOption = document.querySelector('input[name="publishOption"]:checked').value;
      
      let publishMessage = '';
      
      if (selectedOption === 'current') {
        const currentDay = scheduleData.generatedSchedule.days[scheduleData.currentDayIndex];
        publishMessage = `Publishing schedule for ${formatFullDate(currentDay.date)}`;
      } else if (selectedOption === 'all') {
        publishMessage = `Publishing entire schedule (${scheduleData.totalDays} days)`;
      } else if (selectedOption === 'range') {
        const startDate = document.getElementById('publishStartDate').value;
        const endDate = document.getElementById('publishEndDate').value;
        publishMessage = `Publishing schedule from ${formatDisplayDate(startDate)} to ${formatDisplayDate(endDate)}`;
      }
      
      // In a real application, this would publish to a backend
      console.log('Publishing:', selectedOption, publishMessage);
      
      // Update last published date
      const today = new Date();
      document.getElementById('lastPublishedDate').textContent = today.toLocaleDateString('en-GB', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      });
      
      hidePublishModal();
      showSaveIndicator('Schedule published successfully');
      
      alert(publishMessage + '\n\nSchedule has been successfully published!');
    }

    // Update statistics display
    function updateStats() {
      if (scheduleData.generatedSchedule) {
        document.getElementById('totalHours').textContent = scheduleData.generatedSchedule.metrics.totalHours;
        document.getElementById('coverage').textContent = scheduleData.generatedSchedule.metrics.coverage + '%';
        document.getElementById('overtimeHours').textContent = scheduleData.generatedSchedule.metrics.overtime;
        document.getElementById('coverageRate').textContent = scheduleData.generatedSchedule.metrics.coverage + '%';
      }
    }

    // Setup event listeners
    function setupEventListeners() {
      // Tab switching
      document.querySelectorAll(".tab").forEach(tab => {
        tab.addEventListener("click", () => {
          const tabId = tab.dataset.tab;
          
          document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
          tab.classList.add("active");
          
          document.querySelectorAll(".tab-content").forEach(content => {
            content.classList.remove("active");
          });
          
          document.getElementById(`${tabId}Tab`).classList.add("active");
        });
      });
      
      // Date navigation
      prevDayBtn.addEventListener('click', navigatePrevDay);
      nextDayBtn.addEventListener('click', navigateNextDay);
      
      // Interval selector
      intervalBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          const interval = parseInt(btn.dataset.interval);
          scheduleData.currentInterval = interval;
          
          intervalBtns.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          
          if (scheduleData.generatedSchedule) {
            renderDailySchedule();
            renderNetStaffing();
          }
        });
      });
      
      // Save changes button
      saveChangesBtn.addEventListener('click', saveChanges);
      
      // Publish button
      publishBtn.addEventListener('click', showPublishModal);
      
      // Generate button
      generateBtn.addEventListener('click', () => {
        generateSampleSchedule();
        renderDailySchedule();
        renderNetStaffing();
        updateDateDisplay();
        showSaveIndicator('Schedule generated successfully');
      });
      
      // Publish modal
      publishModalCloseBtn.addEventListener('click', hidePublishModal);
      confirmPublishBtn.addEventListener('click', confirmPublish);
      cancelPublishBtn.addEventListener('click', hidePublishModal);
      
      // Close modal when clicking outside
      publishModal.addEventListener('click', (e) => {
        if (e.target === publishModal) {
          hidePublishModal();
        }
      });
      
      // Publish option selection
      document.querySelectorAll('.publish-option').forEach(option => {
        option.addEventListener('click', function() {
          const radio = this.querySelector('input[type="radio"]');
          radio.checked = true;
          
          document.querySelectorAll('.publish-option').forEach(opt => opt.classList.remove('selected'));
          this.classList.add('selected');
          
          // Show/hide date range inputs
          if (radio.value === 'range') {
            document.getElementById('dateRangeInputs').classList.add('active');
          } else {
            document.getElementById('dateRangeInputs').classList.remove('active');
          }
        });
      });
      
      // Save configuration
      saveConfigBtn.addEventListener('click', () => {
        const config = collectConfiguration();
        console.log('Configuration saved:', config);
        showSaveIndicator('Configuration saved');
        
        // Regenerate schedule with new configuration
        generateSampleSchedule();
        renderDailySchedule();
        renderNetStaffing();
      });
      
      // Export button
      exportBtn.addEventListener('click', () => {
        alert('Export functionality would be implemented here. In a real application, this would generate an Excel file.');
      });
      
      // Print button
      printBtn.addEventListener('click', () => {
        window.print();
      });
    }

    // Initialize the application
    init();
  </script>
</body>
</html>
